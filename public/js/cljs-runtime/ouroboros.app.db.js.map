{"version":3,"sources":["ouroboros/app/db.cljs"],"mappings":";AAMA,0BAAA,1BAAMA;AAAN,AAAgB,QAACC,uDAAAA,yDAAAA;;AAEjB,GAAA,QAAAC,sCAAAC,0CAAAC,6CAAAC;AAAA;AAAA,AAAA,AAASC,8BACP,iBAAMC,cAAYC;AAAlB,AAEE,OAACC,uDAAWF;;;AAEhB,GAAA,QAAAL,sCAAAC,0CAAAC,6CAAAM;AAAA;AAAA,AAAA,AAASC,wBAAK,AAACC,6BAAeN;;AAE9B,GAAA,QAAAJ,sCAAAC,0CAAAC,6CAAAS;AAAA;AAAA,AAAA,AAASC,sCAAc,gDAAA,2CAAA,gDAAA,IAAA,/IAACC,mMACcJ;;AAEtC,AAACK,2DAAUL,sBACA,WAAKM;AAAL,AACE,+GAAA,xGAACC,mDAAMJ,oCAAcK,iEAAWC;;AAE7C,4BAAA,5BAAMC,gEAAUC;AAAhB,AACE,IAAMC,OAAK,AAAA,kFAAA,AAAAC,gBAAQV;AAAnB,AACE,OAACW,uDAAWF,KAAKD;;AAGrB,AAAA,qBAAA,6BAAAI,lDAAMM;AAAN,AAAA,IAAAL,qBAAA;AAAA,AAAA,IAAAC,0BAAA,AAAA;AAAA,AAAA,IAAAC,wBAAA;;AAAA,AAAA,GAAA,CAAAA,wBAAAD;AAAA,AAAA,AAAAD,wBAAA,CAAA,UAAAE;;AAAA,eAAA,CAAAA,wBAAA;;;;AAAA;;;;AAAA,IAAAC,uBAAA,EAAA,CAAA,MAAA,AAAAH,4BAAA,AAAA,KAAAI,qBAAA,AAAAJ,yBAAA,KAAA,IAAA,OAAA;AAAA,AAAA,OAAAK,wDAAA,CAAA,UAAA,MAAAF;;;AAAA,AAAA,CAAA,0DAAA,1DAAME,qEAAGM,MAAQrB;AAAjB,AACE,IAAMM,OAAK,AAAA,kFAAA,AAAAC,gBAAQV;AAAnB,AACE,6EAAA,AAAAU,tEAACe,8CAAMC,kBAAIF,sBAAOf,MAAKN;;;AAF3B,CAAA,6CAAA,7CAAMe;;AAAN;AAAA,CAAA,uCAAA,WAAAC,lDAAMD;AAAN,AAAA,IAAAE,WAAA,AAAAC,gBAAAF;IAAAA,eAAA,AAAAG,eAAAH;AAAA,AAAA,IAAAI,qBAAA;AAAA,AAAA,OAAAA,wDAAAH,SAAAD;;;AAAA","names":["ouroboros.app.db/squuid","datascript.core/squuid","js/ouroboros","js/ouroboros.app","js/ouroboros.app.db","js/ouroboros.app.db.datomic-db","ouroboros.app.db/datomic-db","init-schema","ouroboros.app.db-schema/schema","datascript.core.empty_db","js/ouroboros.app.db.conn","ouroboros.app.db/conn","datascript.core/conn-from-db","js/ouroboros.app.db.global-state!","ouroboros.app.db/global-state!","reagent.core.atom","datascript.core.listen_BANG_","args","cljs.core.swap_BANG_","cljs.core/update","cljs.core/inc","ouroboros.app.db/transact","tx-data","conn","cljs.core/deref","datascript.core.transact","var_args","args__5775__auto__","len__5769__auto__","i__5770__auto__","argseq__5776__auto__","cljs.core/IndexedSeq","ouroboros.app.db/q","seq21100","G__21101","cljs.core/first","cljs.core/next","self__5754__auto__","query","cljs.core.apply","datascript.core/q"],"sourcesContent":["(ns ouroboros.app.db\n  (:require [reagent.core :as r]\n            [datascript.core :as d]\n            [ouroboros.app.db-schema :refer [schema]]\n            ))\n\n(defn squuid [] (d/squuid))\n\n(defonce datomic-db\n  (let [init-schema schema]\n\n    (d/empty-db init-schema)))\n\n(defonce conn (d/conn-from-db datomic-db))\n\n(defonce global-state! (r/atom {:tx 0\n                                :conn conn}))\n\n(d/listen! conn\n           (fn [args]\n             (swap! global-state! update :tx inc)))\n\n(defn transact [tx-data]\n  (let [conn (:conn @global-state!)]\n    (d/transact conn tx-data)))\n\n\n(defn q [query & args]\n  (let [conn (:conn @global-state!)]\n    (apply d/q query @conn args)))\n"]}